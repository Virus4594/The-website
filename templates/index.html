<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
 <div class="container">
        <div class="nav">
            <a href="/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            <a href="/login">–õ–æ–≥–∏–Ω</a>
            <a href="/create_post">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</a>
            <a href="/logout">–í—ã–π—Ç–∏</a>
        </div>

        <h2>–í—Å–µ –ø–æ—Å—Ç—ã:</h2>

        {% for post in posts %}
        <div class="post">
            <h3>{{ post.title }}</h3>
            <p>{{ post.content }}</p>
            <small>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ post.date_posted }}</small>

            <div class="post-actions">
                <!-- –õ–∞–π–∫–∏ -->
                <form action="{{ url_for('like_post', post_id=post.id) }}" method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="like-btn">
                        ‚ù§Ô∏è {{ post.likes|length }} –ª–∞–π–∫–æ–≤
                    </button>
                </form>

              <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
                <button class="comment-btn" onclick="toggleComments({{ post.id }})">
                    üí¨ {{ post.comments|length }} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                </button>
            </div>

            <!-- –ë–ª–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ - –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç -->
            <div id="comments-{{ post.id }}" class="comments-section" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</h4>
                    <button class="toggle-comments" onclick="toggleComments({{ post.id }})">–°–∫—Ä—ã—Ç—å</button>
                </div>

                {% for comment in post.comments %}
                <div class="comment">
                    <strong>{{ comment.author.username }}:</strong>
                    <p>{{ comment.text }}</p>
                    <small>{{ comment.date_posted }}</small>
                </div>
                {% endfor %}

                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
                <form action="{{ url_for('add_comment', post_id=post.id) }}" method="POST" class="comment-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <textarea name="comment_text" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required></textarea>
                    <button type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </form>
            </div>
        </div>




    <script>
    function toggleComments(postId) {
        const commentsSection = document.getElementById('comments-' + postId);
        commentsSection.style.display = commentsSection.style.display === 'none' ? 'block' : 'none';
    }
    </script>
    {% endfor %}
</div>


</body>
</html>